<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
  <link rel="stylesheet" href="/admin/pages/css/courses.css">
</head>
<body>

  <a href="/admin/auth/logout">Logout</a>
  <a href="/admin/courses/add">Add Course</a>

  <div class="courses-container"></div>

  <script>
    async function fetchCourses(){
      const response = await fetch("/admin/courses/data")
      const courses = await response.json()
      const coursesContainer = document.querySelector(".courses-container")
      coursesContainer.innerHTML = ""
      courses.forEach(course => {
        const courseCard = document.createElement("div")
        courseCard.innerHTML = `
  <img src="../../uploads/${course.img}" alt="${course.name}">

  <h2>${course.name}</h2>

  <div class="price-box">
    <p><span>Price:</span> ₹${course.price}</p>
    <p><span>Old Price:</span> ₹${course.oldPrice}</p>
    <p><span>Duration:</span> ${course.duration}</p>
    <p><span>Tag:</span> ${course.tag}</p>
  </div>

  <p style="color:#444; margin-top:5px;">Description: ${course.desc}</p>

  <ul class="points-list">
    <span class="points-title">Points:</span>
    ${course.points.map(point => `<li>${point}</li>`).join("")}
  </ul>

  <div class="card-buttons">
    <button class="edit-btn" onclick="edit('${course._id}')">Edit</button>
    <button class="delete-btn" onclick="deleteCourse('${course._id}')">Delete</button>
  </div>
`;

        coursesContainer.appendChild(courseCard)
      })
    }
    fetchCourses()

    async function edit(id){
      window.location.href = `/admin/courses/edit?id=${id}`
    }

    async function deleteCourse(id){
      if(!confirm("Are you sure you want to delete this course?")){
        return
      }
      const response = await fetch(`/admin/courses/delete/${id}`, {
        method: "DELETE"
      })
      if(response.ok){
        fetchCourses()
      }
    }
  </script>
</body>
</html>